% calculations for excel tab 'output' in NIST_elements.xlsx

% exported data from excel 
%   data{atomic number} = [(mass number) (relative atomic mass) (isotope abundance)]
N = 118;
data = cell(N);
data{1}=[	1	1.007825032	0.999885
	2	2.014101778	0.000115
	3	3.016049278	0
];			
data{2}=[	3	3.01602932	0.00000134
	4	4.002603254	0.99999866
];			
data{3}=[	6	6.015122887	0.0759
	7	7.016003437	0.9241
];			
data{4}=[	9	9.012183065	1
];			
data{5}=[	10	10.01293695	0.199
	11	11.00930536	0.801
];			
data{6}=[	12	12	0.9893
	13	13.00335484	0.0107
	14	14.00324199	0
];			
data{7}=[	14	14.003074	0.99636
	15	15.0001089	0.00364
];			
data{8}=[	16	15.99491462	0.99757
	17	16.99913176	0.00038
	18	17.99915961	0.00205
];			
data{9}=[	19	18.99840316	1
];			
data{10}=[	20	19.99244018	0.9048
	21	20.99384669	0.0027
	22	21.99138511	0.0925
];			
data{11}=[	23	22.98976928	1
];			
data{12}=[	24	23.9850417	0.7899
	25	24.98583698	0.1
	26	25.98259297	0.1101
];			
data{13}=[	27	26.98153853	1
];			
data{14}=[	28	27.97692653	0.92223
	29	28.97649466	0.04685
	30	29.97377014	0.03092
];			
data{15}=[	31	30.973762	1
];			
data{16}=[	32	31.97207117	0.9499
	33	32.97145891	0.0075
	34	33.967867	0.0425
	36	35.96708071	0.0001
];			
data{17}=[	35	34.96885268	0.7576
	37	36.9659026	0.2424
];			
data{18}=[	36	35.96754511	0.003336
	38	37.96273211	0.000629
	40	39.96238312	0.996035
];			
data{19}=[	39	38.96370649	0.932581
	40	39.96399817	0.000117
	41	40.96182526	0.067302
];			
data{20}=[	40	39.96259086	0.96941
	42	41.95861783	0.00647
	43	42.95876644	0.00135
	44	43.95548156	0.02086
	46	45.953689	0.00004
	48	47.95252276	0.00187
];			
data{21}=[	45	44.95590828	1
];			
data{22}=[	46	45.95262772	0.0825
	47	46.95175879	0.0744
	48	47.94794198	0.7372
	49	48.94786568	0.0541
	50	49.94478689	0.0518
];			
data{23}=[	50	49.94715601	0.0025
	51	50.94395704	0.9975
];			
data{24}=[	50	49.94604183	0.04345
	52	51.94050623	0.83789
	53	52.94064815	0.09501
	54	53.93887916	0.02365
];			
data{25}=[	55	54.93804391	1
];			
data{26}=[	54	53.93960899	0.05845
	56	55.93493633	0.91754
	57	56.93539284	0.02119
	58	57.93327443	0.00282
];			
data{27}=[	59	58.93319429	1
];			
data{28}=[	58	57.93534241	0.68077
	60	59.93078588	0.26223
	61	60.93105557	0.011399
	62	61.92834537	0.036346
	64	63.92796682	0.009255
];			
data{29}=[	63	62.92959772	0.6915
	65	64.9277897	0.3085
];			
data{30}=[	64	63.92914201	0.4917
	66	65.92603381	0.2773
	67	66.92712775	0.0404
	68	67.92484455	0.1845
	70	69.9253192	0.0061
];			
data{31}=[	69	68.9255735	0.60108
	71	70.92470258	0.39892
];			
data{32}=[	70	69.92424875	0.2057
	72	71.92207583	0.2745
	73	72.92345896	0.0775
	74	73.92117776	0.365
	76	75.92140273	0.0773
];			
data{33}=[	75	74.92159457	1
];			
data{34}=[	74	73.92247593	0.0089
	76	75.9192137	0.0937
	77	76.91991415	0.0763
	78	77.91730928	0.2377
	80	79.9165218	0.4961
	82	81.9166995	0.0873
];			
data{35}=[	79	78.9183376	0.5069
	81	80.9162897	0.4931
];			
data{36}=[	78	77.92036494	0.00355
	80	79.91637808	0.02286
	82	81.91348273	0.11593
	83	82.91412716	0.115
	84	83.91149773	0.56987
	86	85.91061063	0.17279
];			
data{37}=[	85	84.91178974	0.7217
	87	86.90918053	0.2783
];			
data{38}=[	84	83.9134191	0.0056
	86	85.9092606	0.0986
	87	86.9088775	0.07
	88	87.9056125	0.8258
];			
data{39}=[	89	88.9058403	1
];			
data{40}=[	90	89.9046977	0.5145
	91	90.9056396	0.1122
	92	91.9050347	0.1715
	94	93.9063108	0.1738
	96	95.9082714	0.028
];			
data{41}=[	93	92.906373	1
];			
data{42}=[	92	91.90680796	0.1453
	94	93.9050849	0.0915
	95	94.90583877	0.1584
	96	95.90467612	0.1667
	97	96.90601812	0.096
	98	97.90540482	0.2439
	100	99.9074718	0.0982
];			
data{43}=[	97	96.9063667	0.333333333
	98	97.9072124	0.333333333
	99	98.9062508	0.333333333
];			
data{44}=[	96	95.90759025	0.0554
	98	97.9052868	0.0187
	99	98.9059341	0.1276
	100	99.9042143	0.126
	101	100.9055769	0.1706
	102	101.9043441	0.3155
	104	103.9054275	0.1862
];			
data{45}=[	103	102.905498	1
];			
data{46}=[	102	101.9056022	0.0102
	104	103.9040305	0.1114
	105	104.9050796	0.2233
	106	105.9034804	0.2733
	108	107.9038916	0.2646
	110	109.9051722	0.1172
];			
data{47}=[	107	106.9050916	0.51839
	109	108.9047553	0.48161
];			
data{48}=[	106	105.9064599	0.0125
	108	107.9041834	0.0089
	110	109.9030066	0.1249
	111	110.9041829	0.128
	112	111.9027629	0.2413
	113	112.9044081	0.1222
	114	113.9033651	0.2873
	116	115.9047632	0.0749
];			
data{49}=[	113	112.9040618	0.0429
	115	114.9038788	0.9571
];			
data{50}=[	112	111.9048239	0.0097
	114	113.9027827	0.0066
	115	114.9033447	0.0034
	116	115.9017428	0.1454
	117	116.902954	0.0768
	118	117.9016066	0.2422
	119	118.9033112	0.0859
	120	119.9022016	0.3258
	122	121.9034438	0.0463
	124	123.9052766	0.0579
];			
data{51}=[	121	120.903812	0.5721
	123	122.9042132	0.4279
];			
data{52}=[	120	119.9040593	0.0009
	122	121.9030435	0.0255
	123	122.9042698	0.0089
	124	123.9028171	0.0474
	125	124.9044299	0.0707
	126	125.9033109	0.1884
	128	127.9044613	0.3174
	130	129.9062227	0.3408
];			
data{53}=[	127	126.9044719	1
];			
data{54}=[	124	123.905892	0.000952
	126	125.9042983	0.00089
	128	127.903531	0.019102
	129	128.9047809	0.264006
	130	129.9035093	0.04071
	131	130.9050841	0.212324
	132	131.9041551	0.269086
	134	133.9053947	0.104357
	136	135.9072145	0.088573
];			
data{55}=[	133	132.905452	1
];			
data{56}=[	130	129.9063207	0.00106
	132	131.9050611	0.00101
	134	133.9045082	0.02417
	135	134.9056884	0.06592
	136	135.9045757	0.07854
	137	136.9058271	0.11232
	138	137.905247	0.71698
];			
data{57}=[	138	137.9071149	0.0008881
	139	138.9063563	0.9991119
];			
data{58}=[	136	135.9071292	0.00185
	138	137.905991	0.00251
	140	139.9054431	0.8845
	142	141.9092504	0.11114
];			
data{59}=[	141	140.9076576	1
];			
data{60}=[	142	141.907729	0.27152
	143	142.90982	0.12174
	144	143.910093	0.23798
	145	144.9125793	0.08293
	146	145.9131226	0.17189
	148	147.9168993	0.05756
	150	149.9209022	0.05638
];			
data{61}=[	145	144.9127559	0.5
	147	146.915145	0.5
];			
data{62}=[	144	143.9120065	0.0307
	147	146.9149044	0.1499
	148	147.9148292	0.1124
	149	148.9171921	0.1382
	150	149.9172829	0.0738
	152	151.9197397	0.2675
	154	153.9222169	0.2275
];			
data{63}=[	151	150.9198578	0.4781
	153	152.921238	0.5219
];			
data{64}=[	152	151.9197995	0.002
	154	153.9208741	0.0218
	155	154.9226305	0.148
	156	155.9221312	0.2047
	157	156.9239686	0.1565
	158	157.9241123	0.2484
	160	159.9270624	0.2186
];			
data{65}=[	159	158.9253547	1
];			
data{66}=[	156	155.9242847	0.00056
	158	157.9244159	0.00095
	160	159.9252046	0.02329
	161	160.9269405	0.18889
	162	161.9268056	0.25475
	163	162.9287383	0.24896
	164	163.9291819	0.2826
];			
data{67}=[	165	164.9303288	1
];			
data{68}=[	162	161.9287884	0.00139
	164	163.9292088	0.01601
	166	165.9302995	0.33503
	167	166.9320546	0.22869
	168	167.9323767	0.26978
	170	169.9354702	0.1491
];			
data{69}=[	169	168.9342179	1
];			
data{70}=[	168	167.9338896	0.00123
	170	169.9347664	0.02982
	171	170.9363302	0.1409
	172	171.9363859	0.2168
	173	172.9382151	0.16103
	174	173.9388664	0.32026
	176	175.9425764	0.12996
];			
data{71}=[	175	174.9407752	0.97401
	176	175.9426897	0.02599
];			
data{72}=[	174	173.9400461	0.0016
	176	175.9414076	0.0526
	177	176.9432277	0.186
	178	177.9437058	0.2728
	179	178.9458232	0.1362
	180	179.946557	0.3508
];			
data{73}=[	180	179.9474648	0.0001201
	181	180.9479958	0.9998799
];			
data{74}=[	180	179.9467108	0.0012
	182	181.9482039	0.265
	183	182.9502228	0.1431
	184	183.9509309	0.3064
	186	185.9543628	0.2843
];			
data{75}=[	185	184.9529545	0.374
	187	186.9557501	0.626
];			
data{76}=[	184	183.9524885	0.0002
	186	185.953835	0.0159
	187	186.9557474	0.0196
	188	187.9558352	0.1324
	189	188.9581442	0.1615
	190	189.9584437	0.2626
	192	191.961477	0.4078
];			
data{77}=[	191	190.9605893	0.373
	193	192.9629216	0.627
];			
data{78}=[	190	189.9599297	0.00012
	192	191.9610387	0.00782
	194	193.9626809	0.3286
	195	194.9647917	0.3378
	196	195.9649521	0.2521
	198	197.9678949	0.07356
];			
data{79}=[	197	196.9665688	1
];			
data{80}=[	196	195.9658326	0.0015
	198	197.9667686	0.0997
	199	198.9682806	0.1687
	200	199.9683266	0.231
	201	200.9703028	0.1318
	202	201.9706434	0.2986
	204	203.973494	0.0687
];			
data{81}=[	203	202.9723446	0.2952
	205	204.9744278	0.7048
];			
data{82}=[	204	203.973044	0.014
	206	205.9744657	0.241
	207	206.9758973	0.221
	208	207.9766525	0.524
];			
data{83}=[	209	208.9803991	1
];			
data{84}=[	209	208.9824308	0.5
	210	209.9828741	0.5
];			
data{85}=[	210	209.9871479	0.5
	211	210.9874966	0.5
];			
data{86}=[	211	210.9906011	0.333333333
	220	220.0113941	0.333333333
	222	222.0175782	0.333333333
];			
data{87}=[	223	223.019736	1
];			
data{88}=[	223	223.0185023	0.25
	224	224.020212	0.25
	226	226.0254103	0.25
	228	228.0310707	0.25
];			
data{89}=[	227	227.0277523	1
];			
data{90}=[	230	230.0331341	0
	232	232.0380558	1
];			
data{91}=[	231	231.0358842	1
];			
data{92}=[	233	233.0396355	0
	234	234.0409523	0.000054
	235	235.0439301	0.007204
	236	236.0455682	0
	238	238.0507884	0.992742
];			
data{93}=[	236	236.04657	0.5
	237	237.0481736	0.5
];			
data{94}=[	238	238.0495601	0.166666667
	239	239.0521636	0.166666667
	240	240.0538138	0.166666667
	241	241.0568517	0.166666667
	242	242.0587428	0.166666667
	244	244.0642053	0.166666667
];			
data{95}=[	241	241.0568293	0.5
	243	243.0613813	0.5
];			
data{96}=[	243	243.0613893	0.166666667
	244	244.0627528	0.166666667
	245	245.0654915	0.166666667
	246	246.0672238	0.166666667
	247	247.0703541	0.166666667
	248	248.0723499	0.166666667
];			
data{97}=[	247	247.0703073	0.5
	249	249.0749877	0.5
];			
data{98}=[	249	249.0748539	0.25
	250	250.0764062	0.25
	251	251.0795886	0.25
	252	252.0816272	0.25
];			
data{99}=[	252	252.08298	1
];			
data{100}=[	257	257.0951061	1
];			
data{101}=[	258	258.0984315	0.5
	260	260.10365	0.5
];			
data{102}=[	259	259.10103	1
];			
data{103}=[	262	262.10961	1
];			
data{104}=[	267	267.12179	1
];			
data{105}=[	268	268.12567	1
];			
data{106}=[	271	271.13393	1
];			
data{107}=[	272	272.13826	1
];			
data{108}=[	270	270.13429	1
];			
data{109}=[	276	276.15159	1
];			
data{110}=[	281	281.16451	1
];			
data{111}=[	280	280.16514	1
];			
data{112}=[	285	285.17712	1
];			
data{113}=[	284	284.17873	1
];			
data{114}=[	289	289.19042	1
];			
data{115}=[	288	288.19274	1
];			
data{116}=[	293	293.20449	1
];			
data{117}=[	292	292.20746	1
];			
data{118}=[	294	294.21392	1
];

% process data
atomic_number = 1:N;
blank = zeros(N,1);
most_abundant_mass = blank;
most_abundant_mass_number = blank;
lightest_mass = blank;
lightest_mass_number = blank;
average_mass = blank;
average_mass_number = blank;
for n=atomic_number
    mass_number = data{n}(:,1);    
    mass = data{n}(:,2);
    abundances = data{n}(:,3);    
    if sum(abundances) > 1+1e-6
        disp(['error: ' num2str(n) ', (' num2str(sum(abundances)) ')'])
    end
    
    % get most abundant isotope for each
    [~,index] = max(abundances);
    most_abundant_mass(n) = mass(index(1));
    most_abundant_mass_number(n) = mass_number(index(1));
    
    % get lightest isotope for each
    [~,index] = min(mass_number); % or equivalently: min(mass);
    lightest_mass(n) = mass(index(1));
    lightest_mass_number(n) = mass_number(index(1));
    
    % get average for each
    average_mass(n) = sum(abundances.*mass);
    average_mass_number(n) = round(sum(abundances.*mass_number));
    
end
atomic_number = atomic_number';

